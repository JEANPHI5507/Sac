<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAV Automatisme Portail</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>Rapport d'Intervention SAV</h1>
            <p class="company">SAC S√©curit√© - Automatismes de Portail</p>
        </header>

        <div class="progress-bar">
            <div class="progress-step active" data-step="1">Identification</div>
            <div class="progress-step" data-step="2">Client</div>
            <div class="progress-step" data-step="3">√âquipement</div>
            <div class="progress-step" data-step="4">Intervention</div>
            <div class="progress-step" data-step="5">R√©sultats</div>
            <div class="progress-step" data-step="6">Signature</div>
        </div>

        <form id="intervention-form" class="intervention-form">
            <!-- Section 1: Identification -->
            <div class="form-section active" data-section="1">
                <div class="card">
                    <div class="card__header">
                        <h2>Identification de l'Intervention</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="numero-intervention">Num√©ro d'intervention</label>
                            <input type="text" id="numero-intervention" class="form-control" readonly>
                        </div>
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="date-intervention">Date d'intervention</label>
                                <input type="date" id="date-intervention" class="form-control" required>
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="heure-intervention">Heure d'intervention</label>
                                <input type="time" id="heure-intervention" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="nom-technicien">Nom du technicien</label>
                            <input type="text" id="nom-technicien" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="entreprise">Entreprise</label>
                            <input type="text" id="entreprise" class="form-control" value="SAC S√©curit√©" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Client -->
            <div class="form-section" data-section="2">
                <div class="card">
                    <div class="card__header">
                        <h2>Informations Client</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="nom-client">Nom/Raison sociale du client</label>
                            <input type="text" id="nom-client" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="adresse-client">Adresse compl√®te</label>
                            <textarea id="adresse-client" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="contact-nom">Contact sur site (nom)</label>
                                <input type="text" id="contact-nom" class="form-control" required>
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="contact-telephone">T√©l√©phone</label>
                                <input type="tel" id="contact-telephone" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="email-client">Email du client</label>
                            <input type="email" id="email-client" class="form-control">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: √âquipement -->
            <div class="form-section" data-section="3">
                <div class="card">
                    <div class="card__header">
                        <h2>√âquipement</h2>
                    </div>
                    <div class="card__body">
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="type-portail">Type de portail</label>
                                <select id="type-portail" class="form-control" required>
                                    <option value="">S√©lectionner...</option>
                                </select>
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="materiau">Mat√©riau</label>
                                <select id="materiau" class="form-control" required>
                                    <option value="">S√©lectionner...</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="marque-motorisation">Marque de la motorisation</label>
                                <select id="marque-motorisation" class="form-control" required>
                                    <option value="">S√©lectionner...</option>
                                </select>
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="modele-motorisation">Mod√®le de la motorisation</label>
                                <input type="text" id="modele-motorisation" class="form-control">
                            </div>
                        </div>
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="annee-installation">Ann√©e d'installation</label>
                                <input type="number" id="annee-installation" class="form-control" min="1990" max="2030">
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="numero-serie">Num√©ro de s√©rie</label>
                                <input type="text" id="numero-serie" class="form-control">
                            </div>
                        </div>
                        
                        <!-- Photos Section for Equipment -->
                        <div class="photos-section">
                            <div class="photos-header">
                                <h4>Photos de l'√©quipement</h4>
                                <button type="button" class="btn btn--secondary btn--sm photo-btn" data-section="equipment">
                                    üì∑ Ajouter une photo
                                </button>
                            </div>
                            <div class="photos-gallery" id="equipment-gallery">
                                <!-- Photos will be added here dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 4: Intervention -->
            <div class="form-section" data-section="4">
                <div class="card">
                    <div class="card__header">
                        <h2>D√©tails de l'Intervention</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="type-intervention">Type d'intervention</label>
                            <select id="type-intervention" class="form-control" required>
                                <option value="">S√©lectionner...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="probleme-signale">Description du probl√®me signal√©</label>
                            <textarea id="probleme-signale" class="form-control" rows="3" required></textarea>
                        </div>
                        
                        <!-- Photos Before Intervention -->
                        <div class="photos-section">
                            <div class="photos-header">
                                <h4>Photos avant intervention</h4>
                                <button type="button" class="btn btn--secondary btn--sm photo-btn" data-section="before">
                                    üì∑ Photo du probl√®me
                                </button>
                            </div>
                            <div class="photos-gallery" id="before-gallery">
                                <!-- Photos will be added here dynamically -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="diagnostic">Diagnostic r√©alis√©</label>
                            <textarea id="diagnostic" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="actions-effectuees">Actions effectu√©es (d√©taill√©es)</label>
                            <textarea id="actions-effectuees" class="form-control" rows="4" required></textarea>
                        </div>
                        
                        <!-- Photos During Intervention -->
                        <div class="photos-section">
                            <div class="photos-header">
                                <h4>Photos pendant l'intervention</h4>
                                <button type="button" class="btn btn--secondary btn--sm photo-btn" data-section="during">
                                    üì∑ Photo des r√©parations
                                </button>
                            </div>
                            <div class="photos-gallery" id="during-gallery">
                                <!-- Photos will be added here dynamically -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="pieces-remplacees">Pi√®ces remplac√©es/ajout√©es avec r√©f√©rences</label>
                            <textarea id="pieces-remplacees" class="form-control" rows="3" placeholder="Ex: T√©l√©commande ref. XXX, Cellules photo√©lectriques ref. YYY..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="tests-securite">Tests de s√©curit√© effectu√©s</label>
                            <textarea id="tests-securite" class="form-control" rows="2" required></textarea>
                        </div>
                        <div class="flex gap-16">
                            <div class="form-group flex-1">
                                <label class="form-label" for="heure-debut">Heure de d√©but</label>
                                <input type="time" id="heure-debut" class="form-control" required>
                            </div>
                            <div class="form-group flex-1">
                                <label class="form-label" for="heure-fin">Heure de fin</label>
                                <input type="time" id="heure-fin" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="observations">Observations particuli√®res</label>
                            <textarea id="observations" class="form-control" rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 5: R√©sultats -->
            <div class="form-section" data-section="5">
                <div class="card">
                    <div class="card__header">
                        <h2>R√©sultats de l'Intervention</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="etat-fonctionnement">√âtat de fonctionnement apr√®s intervention</label>
                            <select id="etat-fonctionnement" class="form-control" required>
                                <option value="">S√©lectionner...</option>
                                <option value="Excellent">Excellent</option>
                                <option value="Bon">Bon</option>
                                <option value="Satisfaisant">Satisfaisant</option>
                                <option value="D√©faillant">D√©faillant</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Probl√®me r√©solu</label>
                            <div class="radio-group">
                                <label><input type="radio" name="probleme-resolu" value="oui" required> Oui</label>
                                <label><input type="radio" name="probleme-resolu" value="non" required> Non</label>
                            </div>
                        </div>
                        
                        <!-- Photos After Intervention -->
                        <div class="photos-section">
                            <div class="photos-header">
                                <h4>Photos apr√®s intervention</h4>
                                <button type="button" class="btn btn--secondary btn--sm photo-btn" data-section="after">
                                    üì∑ Photo du r√©sultat
                                </button>
                            </div>
                            <div class="photos-gallery" id="after-gallery">
                                <!-- Photos will be added here dynamically -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="recommandations">Recommandations pour le client</label>
                            <textarea id="recommandations" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="prochaine-maintenance">Prochaine maintenance pr√©vue</label>
                            <input type="date" id="prochaine-maintenance" class="form-control">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 6: Signature -->
            <div class="form-section" data-section="6">
                <div class="card">
                    <div class="card__header">
                        <h2>Signature Client</h2>
                    </div>
                    <div class="card__body">
                        <div class="form-group">
                            <label class="form-label" for="nom-signataire">Nom du signataire</label>
                            <input type="text" id="nom-signataire" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Signature √©lectronique</label>
                            <div class="signature-container">
                                <canvas id="signature-canvas" width="400" height="200"></canvas>
                                <div class="signature-controls">
                                    <button type="button" id="clear-signature" class="btn btn--secondary btn--sm">Effacer</button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="date-signature">Date et heure de signature</label>
                            <input type="datetime-local" id="date-signature" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="validation-technicien" required>
                                Validation par le technicien
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="form-navigation">
                <button type="button" id="prev-btn" class="btn btn--secondary" style="display: none;">Pr√©c√©dent</button>
                <button type="button" id="next-btn" class="btn btn--primary">Suivant</button>
                <button type="button" id="generate-report" class="btn btn--primary" style="display: none;">G√©n√©rer le Rapport</button>
            </div>
        </form>

        <!-- Modal de confirmation -->
        <div id="report-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Rapport g√©n√©r√© avec succ√®s</h3>
                </div>
                <div class="modal-body">
                    <p>Le rapport d'intervention a √©t√© g√©n√©r√© avec <span id="photo-count">0</span> photo(s). Que souhaitez-vous faire ?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" id="print-report" class="btn btn--primary">Imprimer</button>
                    <button type="button" id="email-report" class="btn btn--secondary">Envoyer par Email</button>
                    <button type="button" id="new-intervention" class="btn btn--outline">Nouvelle Intervention</button>
                </div>
            </div>
        </div>

        <!-- Photo Camera Modal -->
        <div id="camera-modal" class="modal hidden">
            <div class="modal-content camera-modal">
                <div class="modal-header">
                    <h3>Prendre une photo</h3>
                    <button type="button" id="close-camera" class="btn btn--outline btn--sm">‚úï</button>
                </div>
                <div class="modal-body">
                    <div class="camera-container">
                        <video id="camera-video" autoplay playsinline></video>
                        <canvas id="camera-canvas" style="display: none;"></canvas>
                        <div id="photo-preview" class="photo-preview hidden">
                            <img id="preview-image" alt="Photo preview">
                        </div>
                    </div>
                    <div class="camera-controls">
                        <button type="button" id="switch-camera" class="btn btn--secondary btn--sm">üîÑ Changer cam√©ra</button>
                        <button type="button" id="capture-photo" class="btn btn--primary">üì∑ Capturer</button>
                        <button type="button" id="retake-photo" class="btn btn--secondary hidden">üîÑ Reprendre</button>
                    </div>
                    <div class="photo-caption hidden">
                        <label class="form-label" for="photo-caption-input">L√©gende de la photo</label>
                        <input type="text" id="photo-caption-input" class="form-control" placeholder="D√©crivez la photo...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="save-photo" class="btn btn--primary hidden">Enregistrer la photo</button>
                    <button type="button" id="cancel-photo" class="btn btn--secondary">Annuler</button>
                </div>
            </div>
        </div>

        <!-- File input fallback -->
        <input type="file" id="file-input" accept="image/*" capture="environment" style="display: none;">
    </div>

    <script src="app.js"></script>
</body>
</html>